<!DOCTYPE html>
<html lang="en" ng-app="SKFanApp">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=0">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
	<title>饭掌柜系统</title>

    <!-- Bootstrap -->
    <link href="/renders/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="/css/barrage.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
  </head>
	<body ng-controller="ListCtrl">
		<div class="container-fluid" id="all" style="margin-top:30px">
			<bgsound id="snd-sms" volume="-5000" loop="1" src="/renders/sms.wav" ng-if="browserIE">
			<span id="snd-sms" ng-if="!browserIE"></span>
			<span class="hidden" ng-model="valveLock" ng-init="valveLock = '<%= valveLock %>'"></span>
			<div class="modal" id="modalConfirmDelete">
				<div class="modal-dialog">
					<div class="modal-content">
						<div class="modal-header">
							<button type="button" class="close" data-dismiss="modal" aria-label="Close">
								<span aria-hidden="true">&times;</span>
							</button>
							<h4 class="modal-title">确定取消订单？</h4>
						</div>
						<div class="modal-body">
							{{order.name}}&times;{{order.count}}
							<label class="pull-right">
								<input type="checkbox" value="" ng-model="cancelWithRemove">
								将{{order.name}}从菜单中移除
							</label>
						</div>
						<div class="modal-footer">
							<button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
							<button type="button" class="btn btn-danger" ng-click="cancel()" data-dismiss="modal">确定</button>
						</div>
					</div><!-- /.modal-content -->
				</div><!-- /.modal-dialog -->
			</div><!-- /.modal -->
			
			<div class="row">
				<div id="sidebar" class="col-xs-3 col-md-2 affix">
					<div class="panel panel-default">
	  					<div class="panel-heading text-center"><%= typeName %></div>
						<div class="list-group">
						  <a href="#workingList" class="list-group-item">当前订单<span class="badge" ng-bind="workingListLength"></span></a>
						  <a href="#pickingList" class="list-group-item">等待完成的订单<span class="badge" ng-bind="pickingListLength"></span></a>
						  <a href="#" class="list-group-item disabled"></a>
						  <a href="/kitchen/add" class="list-group-item">添加新品</a>
						  <a href="#" class="list-group-item" ng-click="full()">全屏</a>
						  <a href="#" class="list-group-item list-group-item-<%= valveLock ? 'warning' : 'success' %>">当前<%= valveLock ? '打烊' : '营业' %>中</a>
						  <a href="/kitchen/toggle" class="list-group-item list-group-item-<%= valveLock ? 'success' : 'danger' %>">>我要<%= !valveLock ? '打烊' : '营业' %><</a>
						  <a href="/account/signout" class="list-group-item list-group-item-danger">退出</a>
						</div>
					</div>
				</div>
				<div class="col-xs-9 col-md-10 col-xs-offset-3 col-md-offset-2">
					<div class="col-xs-12" id="workingList">
						<div class="panel panel-primary">
							<div class="panel-heading">
								<h4>当前订单：</h4>
							</div>
							<div class="panel-body">
								<div class="container-fluid">
									<p ng-if="workingList.length == 0">目前还没有订单</p>
									<div class="col-xs-4 col-md-3 ng-cloak" ng-repeat-start="order in workingList track by $index" ng-cloak>
										<div class="thumbnail">
											<img class="img-responsive" ng-src="/image/{{order.image}}/middle" />
											<div class="caption">
												<h4>{{order.name}}</h4>
												<p>{{order.count}}份</p>
												<p class="text-info" am-time-ago="order.placeTime"></p>
												<p>
													<img ng-if="order.uid" style="height:20px" ng-src="/port/{{order.uid}}/thumb" />
													<span ng-if="order.nick" class="text-primary">{{order.nick}} 的订单</span>
												</p>
												<div class="well well-sm">
													<p ng-if="order.phone">联系方式： {{order.phone}}</p>
													<p ng-if="order.location">地点： {{order.location}}</p>
													<p ng-if="order.extra">选项： {{order.extra}}</p>
												</div>
												<button class="btn btn-success" ng-click="remind(order.id)">完成</button> 
												<button class="btn btn-danger" ng-click="prepareCancel($index)" data-toggle="modal" data-target="#modalConfirmDelete">售罄</button>
											</div>
										</div>
									</div>
									<div class="clearfix visible-sm-block visible-xs-block" ng-if="($index + 1 ) % 3 == 0"></div>
									<div class="clearfix visible-md-block visible-lg-block" ng-if="($index + 1 ) % 4 == 0" ng-repeat-end></div>
								</div>
							</div>
						</div>
					</div>
					<div class="col-xs-12" id="pickingList" ng-if="pickingList.length > 0">
						<div class="panel panel-primary">
							<div class="panel-heading">
								<h4>待外送列表：</h4>
							</div>
							<div class="panel-body">
								<div class="container-fluid">
									<div class="col-xs-4 col-md-3 ng-cloak" ng-repeat-start="order in pickingList track by $index" ng-cloak>
										<div class="thumbnail">
											<div class="caption">
												<h4>{{order.name}}</h4>
												<p>{{order.count}}份</p>
												<p class="text-info" am-time-ago="order.placeTime"></p>
												<p>
													<img ng-if="order.uid" style="height:20px" ng-src="/port/{{order.uid}}/thumb" />
													<span ng-if="order.nick" class="text-primary">{{order.nick}} 的订单</span>
												</p>
												<p ng-if="order.phone" class="well well-sm">联系方式： {{order.phone}}</p>
												<p ng-if="order.location" class="well well-sm">地点： {{order.location}}</p>
											</div>
										</div>
									</div>
									<div class="clearfix visible-sm-block visible-xs-block" ng-if="($index + 1 ) % 3 == 0"></div>
									<div class="clearfix visible-md-block visible-lg-block" ng-if="($index + 1 ) % 4 == 0" ng-repeat-end></div>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		
		
		<footer class="text-center">
			<small class="text-muted">&copy;2015 intel成都</small>
		</footer>
		<script src="/js/jquery-1.11.2.min.js"></script>
		<script src="/renders/bootstrap/js/bootstrap.min.js"></script>
		<script type="text/javascript" src="http://ecafe.pub:9527/socket.io/socket.io.js"></script>
		<script src="/renders/angular/angular.min.js"></script>
		<script src="/renders/moment/moment.js"></script>
		<script src="/renders/moment/locale/zh-cn.js"></script>
		<script src="/renders/angular-moment/angular-moment.min.js"></script>
		<script>var type = <%= type %>;</script>
		<script src="/js/barrage.js"></script>
		<script src="/js/kitchen.js"></script>
	</body>
</html>
